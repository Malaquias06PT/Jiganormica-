<!doctype html>
<html lang="pt-PT">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  
  <style>
    :root{
      --bg:#FFF6F9;
      --card:#fff;
      --accent:#FF6B9A;
      --accent-2:#FF9AC2;
      --muted:#8c6a72;
      --shadow: 0 12px 30px rgba(255,107,154,0.16);
      font-family: "Inter", system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      background: radial-gradient(1000px 600px at 10% 10%, rgba(255,154,194,0.12), transparent),
                  linear-gradient(180deg,var(--bg),#FFF);
      display:flex;align-items:center;justify-content:center;padding:24px;
      -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
    }

    .wrap{width:100%;max-width:480px}
    header{display:flex;gap:12px;align-items:center;margin-bottom:18px}
    .logo{width:56px;height:56px;background:linear-gradient(135deg,var(--accent),var(--accent-2));border-radius:12px;display:flex;align-items:center;justify-content:center;color:white;font-weight:700;box-shadow:var(--shadow)}
    h1{margin:0;font-size:18px;color:#5a2834}
    p.lead{margin:6px 0 18px;color:var(--muted);font-size:13px}

    /* Box */
    .stage{display:flex;justify-content:center}
    .box{
      width:260px;height:240px;background:linear-gradient(180deg,#fff0, #fff);border-radius:18px;position:relative;padding-top:28px;display:flex;align-items:flex-start;justify-content:center;flex-direction:column;box-shadow:var(--shadow);
      transform-origin:center;touch-action:none
    }
    .box .lid{position:absolute;left:50%;top:-30px;transform:translateX(-50%);width:240px;height:72px;background:linear-gradient(180deg,var(--accent-2),var(--accent));border-radius:14px 14px 8px 8px;display:flex;align-items:center;justify-content:center;color:white;font-weight:700;box-shadow:0 10px 24px rgba(255,106,150,0.25)}
    .box .lid.open{animation:lidOpen 450ms ease-out forwards}
    @keyframes lidOpen{to{transform:translateX(-50%) translateY(-48px) rotate(-14deg)}}

    .box .heart{font-size:48px;opacity:0;transform:translateY(6px) scale(.9);transition:all 360ms cubic-bezier(.2,.9,.2,1)}
    .box.open .heart{opacity:1;transform:translateY(0) scale(1)}

    .hint{margin-top:12px;text-align:center;color:var(--muted);font-size:13px}

    /* Modal / Surpresa */
    .overlay{position:fixed;inset:0;display:none;align-items:center;justify-content:center;padding:20px}
    .overlay.show{display:flex}
    .card{width:100%;max-width:420px;background:var(--card);border-radius:14px;padding:18px;box-shadow:var(--shadow);text-align:center}
    .close{background:transparent;border:0;font-size:16px;color:var(--muted);position:absolute;right:18px;top:18px}

    .note{font-size:16px;color:#6d2b36;margin-bottom:12px}
    .photo-preview{width:100%;height:220px;border-radius:10px;background:linear-gradient(180deg,#ffeef3,#fff);display:flex;align-items:center;justify-content:center;overflow:hidden;position:relative}
    .photo-preview img{max-width:100%;max-height:100%;object-fit:cover}

    .upload-row{display:flex;gap:8px;justify-content:center;margin-top:10px}
    .btn{background:linear-gradient(90deg,var(--accent),var(--accent-2));color:white;padding:10px 14px;border-radius:12px;border:0;font-weight:700}
    .btn.ghost{background:transparent;color:var(--accent);border:2px solid rgba(255,107,154,0.12)}

    /* Game canvas */
    .game-stage{width:100%;height:300px;border-radius:12px;background:linear-gradient(180deg,#fff,#fff7fb);display:flex;align-items:center;justify-content:center;position:relative}
    canvas{width:100%;height:100%;display:block;border-radius:12px}

    footer{margin-top:14px;text-align:center;color:var(--muted);font-size:13px}

    /* Responsive tweaks */
    @media (max-width:420px){
      .box{width:220px;height:200px}
      .box .lid{width:200px}
    }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="logo">‚ù§</div>
      <div>
        <h1>Ate ja tinha saudades de fazer sites :)</h1>
        <p class="lead">Toca na tela ou mexe o tele pra veres o que faz.</p>
      </div>
    </header>

    <main class="stage">
      <div class="box" id="box" role="button" aria-label="Abrir caixinha">
        <div class="lid" id="lid">Toca / Sacode</div>
        <div style="display:flex;align-items:center;flex-direction:column;padding:18px;">
          <div class="heart">üíñ</div>
          <div style="margin-top:8px;color:#6d2b36;font-weight:700">Surpresa!</div>
        </div>
      </div>
    </main>

    
    <footer>lobe u üíï</footer>
  </div>

  <!-- overlay para a surpresa -->
  <div class="overlay" id="overlay" aria-hidden="true">
    <div class="card" id="card">
      <button class="close" id="closeBtn">‚úï</button>
      <div id="surpriseContent">
        <!-- Conte√∫do injetado por JS -->
      </div>
    </div>
  </div>

  <script>
    // ======= util =======
    const q = sel => document.querySelector(sel);
    const rand = arr => arr[Math.floor(Math.random()*arr.length)];

    const box = q('#box');
    const lid = q('#lid');
    const overlay = q('#overlay');
    const surpriseContent = q('#surpriseContent');
    const closeBtn = q('#closeBtn');

    // mensagens romanticas (podes editar)
    const messages = [
      'Tu √©s o meu cantinho preferido do mundo.',
      'Tenho tanta sorte por te ter. Amo-te muito.',
      'O teu sorriso ilumina os meus dias como ningu√©m.'
    ];

    // Abre a caixinha
    function openBox(){
      box.classList.add('open');
      lid.classList.add('open');
      // pequena vibra√ß√£o se suportado
      if(navigator.vibrate) navigator.vibrate(60);
      setTimeout(()=> showRandomSurprise(),420);
    }

    // Fecha overlay
    function closeOverlay(){
      overlay.classList.remove('show');
      overlay.setAttribute('aria-hidden','true');
      // fechar a tampa suavemente
      box.classList.remove('open');
      lid.classList.remove('open');
    }
    closeBtn.addEventListener('click', closeOverlay);
    overlay.addEventListener('click', (e)=>{ if(e.target===overlay) closeOverlay(); });

    // Escolhe uma surpresa aleat√≥ria
    function showRandomSurprise(){
      const choice = Math.floor(Math.random()*3); // 0: bilhete,1: foto,2:jogo
      overlay.classList.add('show');
      overlay.setAttribute('aria-hidden','false');
      surpriseContent.innerHTML = '';
      if(choice===0) showNote();
      else if(choice===1) showPhotoUploader();
      else showGame();
    }

    // ---- Surpresa 1: bilhete romantico ----
    function showNote(){
      const note = document.createElement('div');
      note.innerHTML = `
        <div style="font-weight:800;color:var(--accent);font-size:14px;margin-bottom:8px;">Bilhete Rom√¢ntico</div>
        <div class="note">"${rand(messages)}"</div>
        <div style="margin-top:8px;"><button class="btn" id="okNote">Guardar miminho</button></div>
      `;
      surpriseContent.appendChild(note);
      q('#okNote').addEventListener('click', ()=>{
        // simula guardar: anima e fecha
        q('#okNote').innerText = 'Guardado üíó';
        setTimeout(closeOverlay,700);
      });
    }

    // ---- Surpresa 2: foto tua (permite upload) ----
    function showPhotoUploader(){
      const container = document.createElement('div');
      container.innerHTML = `
        <div style="font-weight:800;color:var(--accent);font-size:14px;margin-bottom:8px;">Uma foto tua</div>
        <div class="photo-preview" id="photoPreview">
          <div style="text-align:center;color:var(--muted);padding:8px;">
            <div style="font-size:36px;">üì∏</div>
            <div>Carrega uma foto ou usa o bot√£o para escolher</div>
          </div>
        </div>
        <div class="upload-row">
          <label class="btn" for="photoInput">Escolher foto</label>
          <button class="btn ghost" id="usePlaceholder">Manter surpresa</button>
        </div>
        <input type="file" accept="image/*" id="photoInput" style="display:none">
      `;
      surpriseContent.appendChild(container);

      const photoInput = q('#photoInput');
      const preview = q('#photoPreview');
      q('label[for=photoInput]').addEventListener('click', ()=>{});
      photoInput.addEventListener('change', (ev)=>{
        const file = ev.target.files[0];
        if(!file) return;
        const url = URL.createObjectURL(file);
        preview.innerHTML = `<img src="${url}" alt="Foto da namorada" />`;
      });

      q('#usePlaceholder').addEventListener('click', ()=>{
        // colocar um placeholder cute (SVG)
        preview.innerHTML = `<svg width="100%" height="100%" viewBox="0 0 400 300" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid slice"><rect width="100%" height="100%" fill="#fff0"/><g transform="translate(40,20)"><rect x="0" y="0" rx="12" width="320" height="260" fill="#fff" stroke="rgba(255,107,154,0.06)"/><text x="160" y="120" font-size="22" text-anchor="middle" fill="#b05b6a">A tua foto aqui</text><text x="160" y="150" font-size="14" text-anchor="middle" fill="#d38a9a">(pode carregar a tua)</text></g></svg>`;
      });
    }

    // ---- Surpresa 3: mini-jogo de estourar cora√ß√µes ----
    function showGame(){
      surpriseContent.innerHTML = `
        <div style="font-weight:800;color:var(--accent);font-size:14px;margin-bottom:8px;">Estoura Cora√ß√µes</div>
        <div style="margin:6px 0 10px;font-size:14px;color:#6d2b36;font-weight:600;">Cora√ß√µes estourados: <span id=\"score\">0<\/span></div>
        <div class="game-stage"><canvas id="gameCanvas"></canvas></div>
        <div style="margin-top:10px"><button class="btn" id="endGame">Terminar</button></div>
      `;
      const canvas = q('#gameCanvas');
      // ajustar tamanho real
      canvas.width = canvas.clientWidth * devicePixelRatio;
      canvas.height = canvas.clientHeight * devicePixelRatio;
      const ctx = canvas.getContext('2d');
      ctx.scale(devicePixelRatio, devicePixelRatio);

      // cria cora√ß√µes
      const hearts = [];
      let score = 0;
      function spawnHeart(){
        const w = canvas.clientWidth;
        hearts.push({
          x: Math.random()*w,
          y: canvas.clientHeight + 20,
          vy: 0.3 + Math.random()*0.6,
          size: 18 + Math.random()*24,
          popped:false,
          t:0
        });
      }
      for(let i=0;i<8;i++) spawnHeart();
      let last=0;
      function loop(ts){
        const dt = (ts-last)/16.6; last=ts;
        ctx.clearRect(0,0,canvas.clientWidth,canvas.clientHeight);
        // spawn occasionally
        if(Math.random()<0.04) spawnHeart();
        for(let i=hearts.length-1;i>=0;i--){
          const h=hearts[i];
          h.y -= h.vy*dt*6;
          h.t += dt;
          drawHeart(ctx,h.x,h.y,h.size, h.popped, h.t);
          if(h.y < -30 || h.t>1000) hearts.splice(i,1);
        }
        requestAnimationFrame(loop);
      }
      requestAnimationFrame(loop);

      function drawHeart(ctx,x,y,size,popped,t){
        ctx.save();
        ctx.translate(x,y);
        if(popped){
          // simples efeito de "estouro"
          ctx.globalAlpha = Math.max(0,1 - t/30);
        }
        const s = size/40;
        ctx.beginPath();
        ctx.moveTo(0, -10*s);
        ctx.bezierCurveTo(-20*s, -50*s, -60*s, -10*s, 0, 30*s);
        ctx.bezierCurveTo(60*s, -10*s, 20*s, -50*s, 0, -10*s);
        ctx.fillStyle = panelGradient(ctx,size);
        ctx.fill();
        ctx.restore();
      }
      function panelGradient(ctx,size){
        const g = ctx.createLinearGradient(0, -size, 0, size);
        g.addColorStop(0, '#FF9AC2'); g.addColorStop(1,'#FF6B9A');
        return g;
      }

      // tocar / clicar para estourar cora√ß√µes
      canvas.addEventListener('pointerdown', (ev)=>{
        const rect = canvas.getBoundingClientRect();
        const x = (ev.clientX - rect.left);
        const y = (ev.clientY - rect.top);
        // procura cora√ß√£o mais perto
        let best=null; let bi=-1; let bestd=9999;
        for(let i=0;i<hearts.length;i++){
          const h=hearts[i];
          const d = Math.hypot(h.x - x, h.y - y);
          if(d < Math.max(40, h.size) && d<bestd){ best = h; bi=i; bestd=d }
        }
        if(best){
          score++;
          const scEl = document.getElementById('score'); if(scEl) scEl.textContent = score;
          // marca pop
          best.popped = true;
          best.t = 0;
          // adiciona som leve
          if(window.AudioContext){
            try{
              const a = new AudioContext();
              const o = a.createOscillator();
              const g = a.createGain();
              o.type='sine'; o.frequency.value = 750 + Math.random()*200;
              g.gain.value = 0.02;
              o.connect(g); g.connect(a.destination);
              o.start(); o.stop(a.currentTime+0.06);
            }catch(e){}
          }
        }
      });

      q('#endGame').addEventListener('click', ()=>{
        closeOverlay();
      });
    }

    // ===== Intera√ß√£o: toque na caixa =====
    box.addEventListener('click', ()=>{
      openBox();
    });
    // Tamb√©m tocar com toque prolongado (para mobile)
    box.addEventListener('touchstart', ()=>{}, {passive:true});

    // ===== Intera√ß√£o: sacudir o telem√≥vel =====
    // usa DeviceMotion para detectar sacudidelas (apenas em mobiles que suportam)
    if(window.DeviceMotionEvent){
      let lastAccel = {x:0,y:0,z:0};
      let lastTime = 0;
      window.addEventListener('devicemotion', (e)=>{
        const a = e.accelerationIncludingGravity || e.acceleration || {x:0,y:0,z:0};
        const t = Date.now();
        const dt = t - lastTime;
        if(!dt) return;
        const delta = Math.abs(a.x - lastAccel.x) + Math.abs(a.y - lastAccel.y) + Math.abs(a.z - lastAccel.z);
        // threshold heur√≠stico
        if(delta*100 > 18){ // sacodeu
          openBox();
        }
        lastAccel = {x:a.x,y:a.y,z:a.z};
        lastTime = t;
      });
    }

    // Para desktop usar tecla S para demo
    window.addEventListener('keydown',(e)=>{ if(e.key.toLowerCase()==='s') openBox(); });

    // instru√ß√µes: prevenir scroll quando se sacode
    window.addEventListener('touchmove', ()=>{}, {passive:false});
  </script>
</body>
</html>
